# -----------------------------------------------------------------------------
# ASB Platform ECS Environment Example
# -----------------------------------------------------------------------------
# Copy this file to env/ecs.env and customize all values for your environment.
# Never commit the populated env/ecs.env file with real secrets.
# -----------------------------------------------------------------------------

# --- Global Registry Image References (override per release) -----------------
ASB_CP_BACKEND_IMAGE=registry.cn-hangzhou.aliyuncs.com/asb/control-plane-backend:latest
ASB_CP_FRONTEND_IMAGE=registry.cn-hangzhou.aliyuncs.com/asb/control-plane-frontend:latest
ASB_GATEWAY_IMAGE=registry.cn-hangzhou.aliyuncs.com/asb/secure-gateway:latest
ASB_AUTH_IMAGE=registry.cn-hangzhou.aliyuncs.com/asb/auth-service:latest
ASB_POLICY_IMAGE=registry.cn-hangzhou.aliyuncs.com/asb/policy-service:latest
ASB_PRIVACY_IMAGE=registry.cn-hangzhou.aliyuncs.com/asb/privacy-service:latest
ASB_PROMPT_DEFENSE_IMAGE=registry.cn-hangzhou.aliyuncs.com/asb/prompt-defense:latest
ASB_OUTPUT_GUARD_IMAGE=registry.cn-hangzhou.aliyuncs.com/asb/output-guard:latest
ASB_AGENT_CONTROL_IMAGE=registry.cn-hangzhou.aliyuncs.com/asb/agent-control:latest
ASB_AUDIT_IMAGE=registry.cn-hangzhou.aliyuncs.com/asb/audit-service:latest

# Optional infra overrides (leave unset to use defaults in compose)
# POSTGRES_IMAGE=postgres:16-alpine
# REDIS_IMAGE=redis:7-alpine
# KEYCLOAK_IMAGE=quay.io/keycloak/keycloak:24.0
# OPA_IMAGE=openpolicyagent/opa:0.63.0
# CLICKHOUSE_IMAGE=clickhouse/clickhouse-server:23.8

# --- Database Credentials (CHANGE THESE) -------------------------------------
POSTGRES_USER=asb_admin
POSTGRES_PASSWORD=change-me-postgres
POSTGRES_DB=asb_platform

# Control plane application DB
ASB_CP_POSTGRES_DB=asb_control_plane
ASB_CP_POSTGRES_USER=cp_app
ASB_CP_POSTGRES_PASSWORD=change-me-cp

# Auth service DB
AUTH_DB_NAME=asb_auth
AUTH_DB_USER=auth
AUTH_DB_PASSWORD=change-me-auth

# Redis (optional password; leave blank for none)
REDIS_PASSWORD=

# --- Keycloak Configuration --------------------------------------------------
KEYCLOAK_INTERNAL_PORT=8080
KEYCLOAK_PORT=8080                # Host port exposure
KEYCLOAK_DB_URL=jdbc:postgresql://postgres:5432/keycloak
KEYCLOAK_DB_USERNAME=keycloak
KEYCLOAK_DB_PASSWORD=change-me-keycloak-db
KEYCLOAK_ADMIN=admin
KEYCLOAK_ADMIN_PASSWORD=change-me-keycloak-admin
KEYCLOAK_REALM=asb
KEYCLOAK_CLIENT_ID=asb-control-plane
KEYCLOAK_CLIENT_SECRET=change-me-client-secret
KEYCLOAK_BASE_URL=http://keycloak:8080

# --- ClickHouse --------------------------------------------------------------
CLICKHOUSE_DB=asb_events
CLICKHOUSE_USER=default
CLICKHOUSE_PASSWORD=
CLICKHOUSE_TABLE=audit_events
CLICKHOUSE_HTTP_PORT=8123

# --- OPA / Policy ------------------------------------------------------------
OPA_BASE_URL=http://opa:8181
OPA_POLICY_PATH=/v1/data/asb/policies

# --- Gateway + Service URLs --------------------------------------------------
CONTROL_PLANE_URL=http://asb-control-plane-backend:8080
AUTH_SERVICE_URL=http://auth-service:8001
POLICY_SERVICE_URL=http://policy-service:8002
PRIVACY_SERVICE_URL=http://privacy-service:8003
PROMPT_DEFENSE_URL=http://prompt-defense:8004
OUTPUT_GUARD_URL=http://output-guard:8005
AGENT_CONTROL_URL=http://agent-control:8006
AUDIT_SERVICE_URL=http://audit-service:8007
REDIS_URL=redis://redis:6379

# --- Service Ports (host mappings) -------------------------------------------
CP_BACKEND_PORT=8080
CP_FRONTEND_PORT=80
GATEWAY_PORT=8000
KEYCLOAK_PORT=8080
CLICKHOUSE_HTTP_PORT=8123
AUTH_SERVICE_PORT=18001
POLICY_SERVICE_PORT=18002
PRIVACY_SERVICE_PORT=18003
PROMPT_DEFENSE_PORT=18004
OUTPUT_GUARD_PORT=18005
AGENT_CONTROL_PORT=18006
AUDIT_SERVICE_PORT=18007
# PROMETHEUS_PORT=19090
# GRAFANA_PORT=13000

# --- Misc / Additional Overrides --------------------------------------------
RULES_SERVICE_URL=http://opa:8181/v1/data/asb/rules
CP_FRONTEND_API_URL=http://asb-control-plane-backend:8080

# Ensure secrets (passwords, client secrets, tokens) are rotated regularly.

